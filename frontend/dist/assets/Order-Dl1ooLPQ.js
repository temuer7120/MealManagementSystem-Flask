import{d as e,o as a,c as l,a as t,k as r,l as u,r as d,E as o,n as s,h as n,b as i,t as c,q as m,A as p,F as _,C as v,B as f,p as g,_ as h}from"./index-D9a12nsq.js";const b={class:"order-container"},y={class:"card-header"},w={class:"dialog-footer"},V=h(e({__name:"Order",setup(e){const h=d([]),V=d([]),k=d(!1),C=d(null),S=d({id:"",order_number:"",customer_id:"",total_amount:0,order_date:"",status:"pending"}),D=d({customer_id:[{required:!0,message:"请选择客户",trigger:"change"}],total_amount:[{required:!0,message:"请输入订单金额",trigger:"blur"}],order_date:[{required:!0,message:"请选择下单日期",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),x=e=>{switch(e){case"pending":return"warning";case"processing":return"info";case"completed":return"success";case"cancelled":return"danger";default:return"default"}},O=()=>{const e=new Date,a=`ORD-${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}-${String(h.value.length+1).padStart(3,"0")}`;S.value={id:"",order_number:a,customer_id:"",total_amount:0,order_date:e.toISOString().slice(0,19).replace("T"," "),status:"pending"},k.value=!0},q=async()=>{C.value&&await C.value.validate(async e=>{if(e)try{const e=V.value.find(e=>e.id===S.value.customer_id),a=e?e.name:"未知客户";if(S.value.id){const e=h.value.findIndex(e=>e.id===S.value.id);-1!==e&&(h.value[e]={...S.value,customer_name:a}),o.success("订单更新成功")}else{const e={...S.value,id:h.value.length+1,customer_name:a};h.value.push(e),o.success("订单创建成功")}k.value=!1}catch(a){o.error("保存订单失败")}})};return a(()=>{(async()=>{try{h.value=[{id:1,order_number:"ORD-20260204-001",customer_id:1,customer_name:"张女士",total_amount:380,order_date:"2026-02-04 10:30:00",status:"completed"},{id:2,order_number:"ORD-20260204-002",customer_id:2,customer_name:"李女士",total_amount:420,order_date:"2026-02-04 09:15:00",status:"completed"},{id:3,order_number:"ORD-20260204-003",customer_id:3,customer_name:"王女士",total_amount:560,order_date:"2026-02-04 08:45:00",status:"processing"}]}catch(e){o.error("获取订单列表失败")}})(),(async()=>{try{V.value=[{id:1,name:"张女士"},{id:2,name:"李女士"},{id:3,name:"王女士"}]}catch(e){o.error("获取客户列表失败")}})()}),(e,a)=>{const d=s("el-icon"),R=s("el-button"),U=s("el-table-column"),I=s("el-tag"),$=s("el-table"),B=s("el-card"),T=s("el-option"),z=s("el-select"),F=s("el-form-item"),j=s("el-input-number"),A=s("el-date-picker"),E=s("el-form"),M=s("el-dialog");return n(),l("div",b,[a[12]||(a[12]=t("h2",null,"订单管理",-1)),r(B,{shadow:"hover",class:"order-card"},{header:u(()=>[t("div",y,[a[7]||(a[7]=t("span",null,"订单列表",-1)),r(R,{type:"primary",onClick:O},{default:u(()=>[r(d,null,{default:u(()=>[r(m(p))]),_:1}),a[6]||(a[6]=i(" 新增订单 ",-1))]),_:1})])]),default:u(()=>[r($,{data:h.value,style:{width:"100%"}},{default:u(()=>[r(U,{prop:"id",label:"ID",width:"80"}),r(U,{prop:"order_number",label:"订单编号",width:"180"}),r(U,{prop:"customer_name",label:"客户姓名"}),r(U,{prop:"total_amount",label:"订单金额",width:"120"}),r(U,{prop:"order_date",label:"下单日期",width:"180"}),r(U,{prop:"status",label:"状态",width:"100"},{default:u(e=>[r(I,{type:x(e.row.status)},{default:u(()=>[i(c(e.row.status),1)]),_:2},1032,["type"])]),_:1}),r(U,{label:"操作",width:"150"},{default:u(e=>[r(R,{type:"primary",size:"small",onClick:a=>{return l=e.row,S.value={...l},void(k.value=!0);var l}},{default:u(()=>[...a[8]||(a[8]=[i(" 编辑 ",-1)])]),_:1},8,["onClick"]),r(R,{type:"danger",size:"small",onClick:a=>{return l=e.row.id,void f.confirm("确定要删除该订单吗？","删除订单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{h.value=h.value.filter(e=>e.id!==l),o.success("订单删除成功")}catch(e){o.error("删除订单失败")}});var l}},{default:u(()=>[...a[9]||(a[9]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),r(M,{modelValue:k.value,"onUpdate:modelValue":a[5]||(a[5]=e=>k.value=e),title:"订单管理",width:"500px"},{footer:u(()=>[t("span",w,[r(R,{onClick:a[4]||(a[4]=e=>k.value=!1)},{default:u(()=>[...a[10]||(a[10]=[i("取消",-1)])]),_:1}),r(R,{type:"primary",onClick:q},{default:u(()=>[...a[11]||(a[11]=[i("保存",-1)])]),_:1})])]),default:u(()=>[r(E,{model:S.value,rules:D.value,ref_key:"formRef",ref:C},{default:u(()=>[r(F,{label:"客户",prop:"customer_id"},{default:u(()=>[r(z,{modelValue:S.value.customer_id,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value.customer_id=e),placeholder:"请选择客户"},{default:u(()=>[(n(!0),l(_,null,v(V.value,e=>(n(),g(T,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(F,{label:"订单金额",prop:"total_amount"},{default:u(()=>[r(j,{modelValue:S.value.total_amount,"onUpdate:modelValue":a[1]||(a[1]=e=>S.value.total_amount=e),min:0,step:.01,placeholder:"请输入订单金额"},null,8,["modelValue"])]),_:1}),r(F,{label:"下单日期",prop:"order_date"},{default:u(()=>[r(A,{modelValue:S.value.order_date,"onUpdate:modelValue":a[2]||(a[2]=e=>S.value.order_date=e),type:"datetime",placeholder:"选择下单日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),r(F,{label:"状态",prop:"status"},{default:u(()=>[r(z,{modelValue:S.value.status,"onUpdate:modelValue":a[3]||(a[3]=e=>S.value.status=e),placeholder:"请选择状态"},{default:u(()=>[r(T,{label:"待处理",value:"pending"}),r(T,{label:"处理中",value:"processing"}),r(T,{label:"已完成",value:"completed"}),r(T,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-a9dc80b0"]]);export{V as default};
