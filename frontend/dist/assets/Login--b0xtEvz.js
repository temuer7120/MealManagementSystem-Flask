import{d as a,o as e,c as s,a as l,b as r,w as n,v as t,e as o,f as i,g as u,r as d,u as c,h as m,_ as f}from"./index-D9a12nsq.js";import{a as v}from"./index-B1ATcuf8.js";const p={class:"login-container"},b={id:"login-page",class:"auth-container"},g={id:"login-form"},h={class:"mb-3"},y={class:"mb-3"},w=["disabled"],k={class:"mt-3 text-center"},x={key:0,id:"register-page",class:"auth-container"},U={id:"register-form"},V={class:"row"},q={class:"col-md-6"},_={class:"mb-3"},I={class:"mb-3"},C={class:"mb-3"},T={class:"mb-3"},D={class:"mb-3"},S={class:"col-md-6"},j={class:"mb-3"},B={class:"mb-3"},K={class:"mb-3"},N={class:"mb-3"},$=["disabled"],z={class:"mt-3 text-center"},A=f(a({__name:"Login",setup(a){const f=c(),A=d(!1),E=d(!1),J=d(!1),L=d(),O=d(),F=d({username:"",password:""}),G=d({username:"",password:"",name:"",gender:"",age:null,birthdate:null,stayDays:null,phone:"",restrictions:""});e(()=>{F.value.username="",F.value.password="",setTimeout(()=>{var a;null==(a=L.value)||a.focus()},100)});const H=()=>{var a;null==(a=O.value)||a.focus()},M=async()=>{var a,e;if(F.value.username&&F.value.password){A.value=!0;try{const a=await v.post("/api/auth/login",{username:F.value.username,password:F.value.password}),{access_token:e,user:s}=a.data;localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(s)),v.defaults.headers.common.Authorization=`Bearer ${e}`,Q("登录成功","success"),setTimeout(()=>{f.push("/dashboard")},1e3)}catch(s){Q((null==(e=null==(a=s.response)?void 0:a.data)?void 0:e.error)||"登录失败，请检查用户名和密码","danger")}finally{A.value=!1}}else Q("请输入用户名和密码","danger")},P=async()=>{var a,e;if(G.value.username&&G.value.password&&G.value.name){E.value=!0;try{await v.post("/api/auth/register",{username:G.value.username,password:G.value.password,role:"guest"}),Q("注册成功，请登录","success"),setTimeout(()=>{var a;J.value=!1,F.value.username=G.value.username,F.value.password="",null==(a=L.value)||a.focus()},1e3)}catch(s){Q((null==(e=null==(a=s.response)?void 0:a.data)?void 0:e.error)||"注册失败，请重试","danger")}finally{E.value=!1}}else Q("请填写必要信息","danger")},Q=(a,e)=>{const s=document.getElementById("success"===e?"register-message":"login-message");s&&(s.className=`message message-${e}`,s.textContent=a,s.style.display="block",setTimeout(()=>{s.style.display="none"},3e3))};return(a,e)=>(m(),s("div",null,[e[33]||(e[33]=l("nav",{class:"navbar navbar-expand-lg navbar-dark"},[l("div",{class:"container-fluid"},[l("a",{class:"navbar-brand",href:"#"},[l("i",{class:"fas fa-hotel"}),r(" 上海巍阁公司管系统 ")]),l("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbar-nav","aria-controls":"navbar-nav","aria-expanded":"false","aria-label":"Toggle navigation"},[l("span",{class:"navbar-toggler-icon"})]),l("div",{class:"collapse navbar-collapse",id:"navbar-nav"},[l("ul",{class:"navbar-nav me-auto"},[l("li",{class:"nav-item"},[l("a",{class:"nav-link active","aria-current":"page",href:"#dashboard"},[l("i",{class:"fas fa-home"}),r(" 首页 ")])]),l("li",{class:"nav-item"},[l("a",{class:"nav-link",href:"#menus"},[l("i",{class:"fas fa-utensils"}),r(" 菜单管理 ")])]),l("li",{class:"nav-item"},[l("a",{class:"nav-link",href:"#daily-menus"},[l("i",{class:"fas fa-calendar-day"}),r(" 每日餐单 ")])]),l("li",{class:"nav-item"},[l("a",{class:"nav-link",href:"#customers"},[l("i",{class:"fas fa-users"}),r(" 客户管理 ")])]),l("li",{class:"nav-item"},[l("a",{class:"nav-link",href:"#dishes"},[l("i",{class:"fas fa-drumstick-bite"}),r(" 菜品管理 ")])]),l("li",{class:"nav-item dropdown"},[l("a",{class:"nav-link dropdown-toggle",href:"#",id:"admin-dropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[l("i",{class:"fas fa-cog"}),r(" 管理功能 ")]),l("ul",{class:"dropdown-menu","aria-labelledby":"admin-dropdown"},[l("li",null,[l("a",{class:"dropdown-item",href:"#employees"},[l("i",{class:"fas fa-user-tie"}),r(" 员工管理 ")])]),l("li",null,[l("a",{class:"dropdown-item",href:"#finance"},[l("i",{class:"fas fa-money-bill-wave"}),r(" 财务管理 ")])]),l("li",null,[l("a",{class:"dropdown-item",href:"#reports"},[l("i",{class:"fas fa-file-alt"}),r(" 报表打印 ")])])])])]),l("ul",{class:"navbar-nav ms-auto"},[l("li",{class:"nav-item"},[l("span",{class:"nav-link"},[l("i",{class:"fas fa-user"}),r(" 欢迎，"),l("span",{id:"current-user"},"用户")])]),l("li",{class:"nav-item"},[l("button",{class:"btn btn-outline-light",id:"logout-btn"},[l("i",{class:"fas fa-sign-out-alt"}),r(" 退出登录 ")])])])])])],-1)),l("div",p,[l("div",b,[e[18]||(e[18]=l("h2",{class:"auth-title"},[l("i",{class:"fas fa-sign-in-alt"}),r(" 上海巍阁公司管系统 - 登录 ")],-1)),l("form",g,[l("div",h,[e[13]||(e[13]=l("label",{for:"login-username",class:"form-label"},[l("i",{class:"fas fa-user"}),r(" 用户名 ")],-1)),n(l("input",{type:"text",class:"form-control",id:"login-username","onUpdate:modelValue":e[0]||(e[0]=a=>F.value.username=a),onKeyup:o(H,["enter"]),ref_key:"usernameInput",ref:L,required:"",placeholder:"请输入用户名"},null,544),[[t,F.value.username]])]),l("div",y,[e[14]||(e[14]=l("label",{for:"login-password",class:"form-label"},[l("i",{class:"fas fa-lock"}),r(" 密码 ")],-1)),n(l("input",{type:"password",class:"form-control",id:"login-password","onUpdate:modelValue":e[1]||(e[1]=a=>F.value.password=a),onKeyup:o(M,["enter"]),ref_key:"passwordInput",ref:O,required:"",placeholder:"请输入密码"},null,544),[[t,F.value.password]])]),l("button",{type:"button",class:"btn btn-primary w-100",onClick:M,disabled:A.value},[...e[15]||(e[15]=[l("i",{class:"fas fa-sign-in-alt"},null,-1),r(" 登录 ",-1)])],8,w),l("div",k,[l("button",{type:"button",class:"btn btn-link",id:"show-register-btn",onClick:e[2]||(e[2]=a=>J.value=!0)},[...e[16]||(e[16]=[l("i",{class:"fas fa-user-plus"},null,-1),r(" 访客注册 ",-1)])])]),e[17]||(e[17]=l("div",{id:"login-message",class:"message",style:{display:"none"}},null,-1))])]),J.value?(m(),s("div",x,[e[32]||(e[32]=l("h2",{class:"auth-title"},[l("i",{class:"fas fa-user-plus"}),r(" 访客注册 ")],-1)),l("form",U,[l("div",V,[l("div",q,[l("div",_,[e[19]||(e[19]=l("label",{for:"register-username",class:"form-label"},[l("i",{class:"fas fa-user"}),r(" 用户名 ")],-1)),n(l("input",{type:"text",class:"form-control",id:"register-username","onUpdate:modelValue":e[3]||(e[3]=a=>G.value.username=a),required:"",placeholder:"请输入用户名"},null,512),[[t,G.value.username]])]),l("div",I,[e[20]||(e[20]=l("label",{for:"register-password",class:"form-label"},[l("i",{class:"fas fa-lock"}),r(" 密码 ")],-1)),n(l("input",{type:"password",class:"form-control",id:"register-password","onUpdate:modelValue":e[4]||(e[4]=a=>G.value.password=a),required:"",placeholder:"请输入密码"},null,512),[[t,G.value.password]])]),l("div",C,[e[21]||(e[21]=l("label",{for:"register-name",class:"form-label"},[l("i",{class:"fas fa-id-card"}),r(" 姓名 ")],-1)),n(l("input",{type:"text",class:"form-control",id:"register-name","onUpdate:modelValue":e[5]||(e[5]=a=>G.value.name=a),required:"",placeholder:"请输入姓名"},null,512),[[t,G.value.name]])]),l("div",T,[e[23]||(e[23]=l("label",{for:"register-gender",class:"form-label"},[l("i",{class:"fas fa-venus-mars"}),r(" 性别 ")],-1)),n(l("select",{class:"form-control",id:"register-gender","onUpdate:modelValue":e[6]||(e[6]=a=>G.value.gender=a),required:""},[...e[22]||(e[22]=[l("option",{value:""},"请选择",-1),l("option",{value:"男"},"男",-1),l("option",{value:"女"},"女",-1)])],512),[[i,G.value.gender]])]),l("div",D,[e[24]||(e[24]=l("label",{for:"register-age",class:"form-label"},[l("i",{class:"fas fa-birthday-cake"}),r(" 年龄 ")],-1)),n(l("input",{type:"number",class:"form-control",id:"register-age","onUpdate:modelValue":e[7]||(e[7]=a=>G.value.age=a),required:"",placeholder:"请输入年龄"},null,512),[[t,G.value.age]])])]),l("div",S,[l("div",j,[e[25]||(e[25]=l("label",{for:"register-birthdate",class:"form-label"},[l("i",{class:"fas fa-calendar-alt"}),r(" 出生日期 ")],-1)),n(l("input",{type:"date",class:"form-control",id:"register-birthdate","onUpdate:modelValue":e[8]||(e[8]=a=>G.value.birthdate=a),required:""},null,512),[[t,G.value.birthdate]])]),l("div",B,[e[26]||(e[26]=l("label",{for:"register-stay-days",class:"form-label"},[l("i",{class:"fas fa-hotel"}),r(" 计划入住天数 ")],-1)),n(l("input",{type:"number",class:"form-control",id:"register-stay-days","onUpdate:modelValue":e[9]||(e[9]=a=>G.value.stayDays=a),required:"",placeholder:"请输入计划入住天数"},null,512),[[t,G.value.stayDays]])]),l("div",K,[e[27]||(e[27]=l("label",{for:"register-phone",class:"form-label"},[l("i",{class:"fas fa-phone"}),r(" 联系电话 ")],-1)),n(l("input",{type:"tel",class:"form-control",id:"register-phone","onUpdate:modelValue":e[10]||(e[10]=a=>G.value.phone=a),required:"",placeholder:"请输入联系电话"},null,512),[[t,G.value.phone]])]),l("div",N,[e[28]||(e[28]=l("label",{for:"register-restrictions",class:"form-label"},[l("i",{class:"fas fa-utensils"}),r(" 饮食禁忌 ")],-1)),n(l("textarea",{class:"form-control",id:"register-restrictions","onUpdate:modelValue":e[11]||(e[11]=a=>G.value.restrictions=a),rows:"3",placeholder:"请输入饮食禁忌"},null,512),[[t,G.value.restrictions]])])])]),l("button",{type:"button",class:"btn btn-primary w-100",onClick:P,disabled:E.value},[...e[29]||(e[29]=[l("i",{class:"fas fa-user-plus"},null,-1),r(" 注册 ",-1)])],8,$),l("div",z,[l("button",{type:"button",class:"btn btn-link",id:"show-login-btn",onClick:e[12]||(e[12]=a=>J.value=!1)},[...e[30]||(e[30]=[l("i",{class:"fas fa-sign-in-alt"},null,-1),r(" 已有账号？登录 ",-1)])])]),e[31]||(e[31]=l("div",{id:"register-message",class:"message",style:{display:"none"}},null,-1))])])):u("",!0)])]))}}),[["__scopeId","data-v-204de1af"]]);export{A as default};
