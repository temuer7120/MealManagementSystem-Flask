import{d as e,o as a,c as l,a as t,k as u,l as r,r as d,E as s,n as o,h as i,b as n,t as c,q as m,A as p,p as v,g as f,B as _,_ as h}from"./index-D9a12nsq.js";const y={class:"system-container"},b={class:"card-header"},w={class:"card-header"},V={class:"system-info"},g={class:"dialog-footer"},k={class:"dialog-footer"},C=h(e({__name:"System",setup(e){const h=d("users"),C=d([]),x=d([]),U=d(!1),q=d(!1),I=d(null),B=d(null),z=d({id:"",username:"",email:"",password:"",role:"staff",is_active:!0}),T=d({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]}),A=d({id:"",name:"",description:""}),D=d({name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]}),E=e=>{switch(e){case"admin":return"danger";case"nutritionist":return"success";case"chef":return"warning";case"staff":return"info";default:return"default"}},F=()=>{z.value={id:"",username:"",email:"",password:"",role:"staff",is_active:!0},U.value=!0},P=async()=>{I.value&&await I.value.validate(async e=>{if(e)try{if(z.value.id){const e=C.value.findIndex(e=>e.id===z.value.id);-1!==e&&(C.value[e]={...z.value}),s.success("用户更新成功")}else{const e={...z.value,id:C.value.length+1};C.value.push(e),s.success("用户创建成功")}U.value=!1}catch(a){s.error("保存用户失败")}})},R=()=>{A.value={id:"",name:"",description:""},q.value=!0},S=async()=>{B.value&&await B.value.validate(async e=>{if(e)try{if(A.value.id){const e=x.value.findIndex(e=>e.id===A.value.id);-1!==e&&(x.value[e]={...A.value}),s.success("角色更新成功")}else{const e={...A.value,id:x.value.length+1};x.value.push(e),s.success("角色创建成功")}q.value=!1}catch(a){s.error("保存角色失败")}})};return a(()=>{(async()=>{try{C.value=[{id:1,username:"admin",email:"admin@example.com",role:"admin",is_active:!0},{id:2,username:"nutritionist",email:"nutritionist@example.com",role:"nutritionist",is_active:!0},{id:3,username:"chef",email:"chef@example.com",role:"chef",is_active:!0}]}catch(e){s.error("获取用户列表失败")}})(),(async()=>{try{x.value=[{id:1,name:"admin",description:"系统管理员"},{id:2,name:"nutritionist",description:"营养师"},{id:3,name:"chef",description:"厨师"},{id:4,name:"staff",description:"普通员工"}]}catch(e){s.error("获取角色列表失败")}})()}),(e,a)=>{const d=o("el-icon"),j=o("el-button"),L=o("el-table-column"),M=o("el-tag"),Q=o("el-switch"),$=o("el-table"),G=o("el-card"),H=o("el-tab-pane"),J=o("el-descriptions-item"),K=o("el-descriptions"),N=o("el-tabs"),O=o("el-input"),W=o("el-form-item"),X=o("el-option"),Y=o("el-select"),Z=o("el-form"),ee=o("el-dialog");return i(),l("div",y,[a[30]||(a[30]=t("h2",null,"系统设置",-1)),u(N,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=e=>h.value=e),class:"system-tabs"},{default:r(()=>[u(H,{label:"用户管理",name:"users"},{default:r(()=>[u(G,{shadow:"hover",class:"system-card"},{header:r(()=>[t("div",b,[a[13]||(a[13]=t("span",null,"用户列表",-1)),u(j,{type:"primary",onClick:F},{default:r(()=>[u(d,null,{default:r(()=>[u(m(p))]),_:1}),a[12]||(a[12]=n(" 新增用户 ",-1))]),_:1})])]),default:r(()=>[u($,{data:C.value,style:{width:"100%"}},{default:r(()=>[u(L,{prop:"id",label:"ID",width:"80"}),u(L,{prop:"username",label:"用户名"}),u(L,{prop:"email",label:"邮箱",width:"200"}),u(L,{prop:"role",label:"角色",width:"120"},{default:r(e=>[u(M,{type:E(e.row.role)},{default:r(()=>[n(c(e.row.role),1)]),_:2},1032,["type"])]),_:1}),u(L,{prop:"is_active",label:"状态",width:"100"},{default:r(e=>[u(Q,{modelValue:e.row.is_active,"onUpdate:modelValue":a=>e.row.is_active=a,onChange:a=>{return l=e.row,void s.success(`用户 ${l.username} 状态已更新`);var l}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),u(L,{label:"操作",width:"150"},{default:r(e=>[u(j,{type:"primary",size:"small",onClick:a=>{return l=e.row,z.value={...l},void(U.value=!0);var l}},{default:r(()=>[...a[14]||(a[14]=[n(" 编辑 ",-1)])]),_:1},8,["onClick"]),u(j,{type:"danger",size:"small",onClick:a=>{return l=e.row.id,void _.confirm("确定要删除该用户吗？","删除用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{C.value=C.value.filter(e=>e.id!==l),s.success("用户删除成功")}catch(e){s.error("删除用户失败")}});var l}},{default:r(()=>[...a[15]||(a[15]=[n(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),u(H,{label:"角色管理",name:"roles"},{default:r(()=>[u(G,{shadow:"hover",class:"system-card"},{header:r(()=>[t("div",w,[a[17]||(a[17]=t("span",null,"角色列表",-1)),u(j,{type:"primary",onClick:R},{default:r(()=>[u(d,null,{default:r(()=>[u(m(p))]),_:1}),a[16]||(a[16]=n(" 新增角色 ",-1))]),_:1})])]),default:r(()=>[u($,{data:x.value,style:{width:"100%"}},{default:r(()=>[u(L,{prop:"id",label:"ID",width:"80"}),u(L,{prop:"name",label:"角色名称"}),u(L,{prop:"description",label:"描述"}),u(L,{label:"操作",width:"150"},{default:r(e=>[u(j,{type:"primary",size:"small",onClick:a=>{return l=e.row,A.value={...l},void(q.value=!0);var l}},{default:r(()=>[...a[18]||(a[18]=[n(" 编辑 ",-1)])]),_:1},8,["onClick"]),u(j,{type:"danger",size:"small",onClick:a=>{return l=e.row.id,void _.confirm("确定要删除该角色吗？","删除角色",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{x.value=x.value.filter(e=>e.id!==l),s.success("角色删除成功")}catch(e){s.error("删除角色失败")}});var l}},{default:r(()=>[...a[19]||(a[19]=[n(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),u(H,{label:"系统信息",name:"info"},{default:r(()=>[u(G,{shadow:"hover",class:"system-card"},{header:r(()=>[...a[20]||(a[20]=[t("div",{class:"card-header"},[t("span",null,"系统信息")],-1)])]),default:r(()=>[t("div",V,[u(K,{column:1,border:""},{default:r(()=>[u(J,{label:"系统版本"},{default:r(()=>[...a[21]||(a[21]=[n("1.0.0",-1)])]),_:1}),u(J,{label:"后端API地址"},{default:r(()=>[...a[22]||(a[22]=[n("http://127.0.0.1:5000/api",-1)])]),_:1}),u(J,{label:"数据库类型"},{default:r(()=>[...a[23]||(a[23]=[n("MySQL",-1)])]),_:1}),u(J,{label:"前端框架"},{default:r(()=>[...a[24]||(a[24]=[n("Vue 3 + Element Plus",-1)])]),_:1}),u(J,{label:"最后更新时间"},{default:r(()=>[...a[25]||(a[25]=[n("2026-02-04",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(ee,{modelValue:U.value,"onUpdate:modelValue":a[7]||(a[7]=e=>U.value=e),title:"用户管理",width:"500px"},{footer:r(()=>[t("span",g,[u(j,{onClick:a[6]||(a[6]=e=>U.value=!1)},{default:r(()=>[...a[26]||(a[26]=[n("取消",-1)])]),_:1}),u(j,{type:"primary",onClick:P},{default:r(()=>[...a[27]||(a[27]=[n("保存",-1)])]),_:1})])]),default:r(()=>[u(Z,{model:z.value,rules:T.value,ref_key:"userFormRef",ref:I},{default:r(()=>[u(W,{label:"用户名",prop:"username"},{default:r(()=>[u(O,{modelValue:z.value.username,"onUpdate:modelValue":a[1]||(a[1]=e=>z.value.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),u(W,{label:"邮箱",prop:"email"},{default:r(()=>[u(O,{modelValue:z.value.email,"onUpdate:modelValue":a[2]||(a[2]=e=>z.value.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),z.value.id?f("",!0):(i(),v(W,{key:0,label:"密码",prop:"password"},{default:r(()=>[u(O,{modelValue:z.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>z.value.password=e),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1})),u(W,{label:"角色",prop:"role"},{default:r(()=>[u(Y,{modelValue:z.value.role,"onUpdate:modelValue":a[4]||(a[4]=e=>z.value.role=e),placeholder:"请选择角色"},{default:r(()=>[u(X,{label:"admin",value:"admin"}),u(X,{label:"nutritionist",value:"nutritionist"}),u(X,{label:"chef",value:"chef"}),u(X,{label:"staff",value:"staff"})]),_:1},8,["modelValue"])]),_:1}),u(W,{label:"状态"},{default:r(()=>[u(Q,{modelValue:z.value.is_active,"onUpdate:modelValue":a[5]||(a[5]=e=>z.value.is_active=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),u(ee,{modelValue:q.value,"onUpdate:modelValue":a[11]||(a[11]=e=>q.value=e),title:"角色管理",width:"500px"},{footer:r(()=>[t("span",k,[u(j,{onClick:a[10]||(a[10]=e=>q.value=!1)},{default:r(()=>[...a[28]||(a[28]=[n("取消",-1)])]),_:1}),u(j,{type:"primary",onClick:S},{default:r(()=>[...a[29]||(a[29]=[n("保存",-1)])]),_:1})])]),default:r(()=>[u(Z,{model:A.value,rules:D.value,ref_key:"roleFormRef",ref:B},{default:r(()=>[u(W,{label:"角色名称",prop:"name"},{default:r(()=>[u(O,{modelValue:A.value.name,"onUpdate:modelValue":a[8]||(a[8]=e=>A.value.name=e),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),u(W,{label:"描述",prop:"description"},{default:r(()=>[u(O,{modelValue:A.value.description,"onUpdate:modelValue":a[9]||(a[9]=e=>A.value.description=e),type:"textarea",placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-ecc57da2"]]);export{C as default};
