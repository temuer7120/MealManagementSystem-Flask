import{d as e,o as a,c as l,a as i,k as t,l as d,r,E as u,n as o,h as c,b as s,t as n,q as p,A as v,F as m,C as _,B as f,p as y,_ as h}from"./index-D9a12nsq.js";const g={class:"dish-container"},b={class:"card-header"},V={class:"dialog-footer"},w=h(e({__name:"Dish",setup(e){const h=r([]),w=r([]),k=r(!1),C=r(null),x=r({id:"",name:"",description:"",price:0,category_id:"",is_active:!0}),U=r({name:[{required:!0,message:"请输入菜品名称",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"}],category_id:[{required:!0,message:"请选择分类",trigger:"change"}]}),q=e=>{const a=w.value.find(a=>a.id===e);return a?a.name:"未知分类"},B=()=>{x.value={id:"",name:"",description:"",price:0,category_id:"",is_active:!0},k.value=!0},I=async()=>{C.value&&await C.value.validate(async e=>{if(e)try{if(x.value.id){const e=h.value.findIndex(e=>e.id===x.value.id);-1!==e&&(h.value[e]={...x.value}),u.success("菜品更新成功")}else{const e={...x.value,id:h.value.length+1};h.value.push(e),u.success("菜品创建成功")}k.value=!1}catch(a){u.error("保存菜品失败")}})};return a(()=>{(async()=>{try{h.value=[{id:1,name:"清蒸鱼",description:"新鲜鲈鱼清蒸",price:88,category_id:1,is_active:!0},{id:2,name:"红烧肉",description:"传统红烧肉",price:68,category_id:1,is_active:!0},{id:3,name:"蔬菜沙拉",description:"新鲜蔬菜沙拉",price:38,category_id:2,is_active:!0}]}catch(e){u.error("获取菜品列表失败")}})(),(async()=>{try{w.value=[{id:1,name:"主菜"},{id:2,name:"配菜"},{id:3,name:"汤品"},{id:4,name:"点心"}]}catch(e){u.error("获取分类列表失败")}})()}),(e,a)=>{const r=o("el-icon"),z=o("el-button"),D=o("el-table-column"),T=o("el-tag"),j=o("el-table"),A=o("el-card"),E=o("el-input"),F=o("el-form-item"),R=o("el-input-number"),G=o("el-option"),H=o("el-select"),J=o("el-switch"),K=o("el-form"),L=o("el-dialog");return c(),l("div",g,[a[13]||(a[13]=i("h2",null,"菜品管理",-1)),t(A,{shadow:"hover",class:"dish-card"},{header:d(()=>[i("div",b,[a[8]||(a[8]=i("span",null,"菜品列表",-1)),t(z,{type:"primary",onClick:B},{default:d(()=>[t(r,null,{default:d(()=>[t(p(v))]),_:1}),a[7]||(a[7]=s(" 新增菜品 ",-1))]),_:1})])]),default:d(()=>[t(j,{data:h.value,style:{width:"100%"}},{default:d(()=>[t(D,{prop:"id",label:"ID",width:"80"}),t(D,{prop:"name",label:"菜品名称"}),t(D,{prop:"description",label:"描述"}),t(D,{prop:"price",label:"价格",width:"100"}),t(D,{prop:"category_id",label:"分类",width:"120"},{default:d(e=>[s(n(q(e.row.category_id)),1)]),_:1}),t(D,{prop:"is_active",label:"状态",width:"100"},{default:d(e=>[t(T,{type:e.row.is_active?"success":"danger"},{default:d(()=>[s(n(e.row.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(D,{label:"操作",width:"150"},{default:d(e=>[t(z,{type:"primary",size:"small",onClick:a=>{return l=e.row,x.value={...l},void(k.value=!0);var l}},{default:d(()=>[...a[9]||(a[9]=[s(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(z,{type:"danger",size:"small",onClick:a=>{return l=e.row.id,void f.confirm("确定要删除该菜品吗？","删除菜品",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{h.value=h.value.filter(e=>e.id!==l),u.success("菜品删除成功")}catch(e){u.error("删除菜品失败")}});var l}},{default:d(()=>[...a[10]||(a[10]=[s(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(L,{modelValue:k.value,"onUpdate:modelValue":a[6]||(a[6]=e=>k.value=e),title:"菜品管理",width:"500px"},{footer:d(()=>[i("span",V,[t(z,{onClick:a[5]||(a[5]=e=>k.value=!1)},{default:d(()=>[...a[11]||(a[11]=[s("取消",-1)])]),_:1}),t(z,{type:"primary",onClick:I},{default:d(()=>[...a[12]||(a[12]=[s("保存",-1)])]),_:1})])]),default:d(()=>[t(K,{model:x.value,rules:U.value,ref_key:"formRef",ref:C},{default:d(()=>[t(F,{label:"菜品名称",prop:"name"},{default:d(()=>[t(E,{modelValue:x.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.name=e),placeholder:"请输入菜品名称"},null,8,["modelValue"])]),_:1}),t(F,{label:"描述",prop:"description"},{default:d(()=>[t(E,{modelValue:x.value.description,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.description=e),type:"textarea",placeholder:"请输入菜品描述"},null,8,["modelValue"])]),_:1}),t(F,{label:"价格",prop:"price"},{default:d(()=>[t(R,{modelValue:x.value.price,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value.price=e),min:0,step:.01,placeholder:"请输入价格"},null,8,["modelValue"])]),_:1}),t(F,{label:"分类",prop:"category_id"},{default:d(()=>[t(H,{modelValue:x.value.category_id,"onUpdate:modelValue":a[3]||(a[3]=e=>x.value.category_id=e),placeholder:"请选择分类"},{default:d(()=>[(c(!0),l(m,null,_(w.value,e=>(c(),y(G,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(F,{label:"状态"},{default:d(()=>[t(J,{modelValue:x.value.is_active,"onUpdate:modelValue":a[4]||(a[4]=e=>x.value.is_active=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-3004c940"]]);export{w as default};
