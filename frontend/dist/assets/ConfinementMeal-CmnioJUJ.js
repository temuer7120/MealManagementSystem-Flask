import{d as e,o as a,c as l,k as t,l as d,r as n,E as o,n as r,h as u,b as s,a as i,q as p,A as c,B as m,_}from"./index-D9a12nsq.js";import{a as f}from"./index-B1ATcuf8.js";const v={class:"confinement-meal-container"},y={class:"card-header"},h={class:"dialog-footer"},b=_(e({__name:"ConfinementMeal",setup(e){const _=n([]),b=n(!1),g=n(null),w=n(!1),V=n({name:"",start_date:"",end_date:"",description:""}),k=n({name:[{required:!0,message:"请输入计划名称",trigger:"blur"}],start_date:[{required:!0,message:"请选择开始日期",trigger:"change"}],end_date:[{required:!0,message:"请选择结束日期",trigger:"change"}]}),C=async()=>{try{const e=await f.get("/api/confinement_meal_plans");_.value=e.data}catch(e){o.error("获取月子餐计划失败")}},x=e=>{e?(w.value=!0,V.value={...e}):(w.value=!1,V.value={name:"",start_date:"",end_date:"",description:""}),b.value=!0},U=async()=>{g.value&&await g.value.validate(async e=>{if(e)try{w.value?(await f.put(`/api/confinement_meal_plans/${V.value.id}`,V.value),o.success("计划更新成功")):(await f.post("/api/confinement_meal_plans",V.value),o.success("计划创建成功")),b.value=!1,C()}catch(a){o.error("操作失败")}})};return a(()=>{C()}),(e,a)=>{const n=r("el-icon"),q=r("el-button"),B=r("el-table-column"),j=r("el-table"),z=r("el-card"),I=r("el-input"),T=r("el-form-item"),$=r("el-date-picker"),A=r("el-form"),D=r("el-dialog");return u(),l("div",v,[t(z,{shadow:"hover"},{header:d(()=>[i("div",y,[a[7]||(a[7]=i("span",null,"月子餐计划",-1)),t(q,{type:"primary",onClick:x},{default:d(()=>[t(n,null,{default:d(()=>[t(p(c))]),_:1}),a[6]||(a[6]=s(" 新增计划 ",-1))]),_:1})])]),default:d(()=>[t(j,{data:_.value,style:{width:"100%"}},{default:d(()=>[t(B,{prop:"id",label:"计划ID",width:"80"}),t(B,{prop:"name",label:"计划名称"}),t(B,{prop:"start_date",label:"开始日期"}),t(B,{prop:"end_date",label:"结束日期"}),t(B,{prop:"description",label:"描述"}),t(B,{label:"操作",width:"150"},{default:d(e=>[t(q,{type:"primary",size:"small",onClick:a=>(e.row,void o.info("查看计划详情功能开发中"))},{default:d(()=>[...a[8]||(a[8]=[s(" 查看 ",-1)])]),_:1},8,["onClick"]),t(q,{type:"danger",size:"small",onClick:a=>{return l=e.row.id,void m.confirm("确定要删除该计划吗？","删除计划",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await f.delete(`/api/confinement_meal_plans/${l}`),o.success("计划删除成功"),C()}catch(e){o.error("删除失败")}});var l}},{default:d(()=>[...a[9]||(a[9]=[s(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(D,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=e=>b.value=e),title:w.value?"编辑月子餐计划":"新增月子餐计划",width:"600px"},{footer:d(()=>[i("span",h,[t(q,{onClick:a[4]||(a[4]=e=>b.value=!1)},{default:d(()=>[...a[10]||(a[10]=[s("取消",-1)])]),_:1}),t(q,{type:"primary",onClick:U},{default:d(()=>[...a[11]||(a[11]=[s("确认",-1)])]),_:1})])]),default:d(()=>[t(A,{model:V.value,rules:k.value,ref_key:"formRef",ref:g},{default:d(()=>[t(T,{label:"计划名称",prop:"name"},{default:d(()=>[t(I,{modelValue:V.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value.name=e),placeholder:"请输入计划名称"},null,8,["modelValue"])]),_:1}),t(T,{label:"开始日期",prop:"start_date"},{default:d(()=>[t($,{modelValue:V.value.start_date,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value.start_date=e),type:"date",placeholder:"选择开始日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(T,{label:"结束日期",prop:"end_date"},{default:d(()=>[t($,{modelValue:V.value.end_date,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value.end_date=e),type:"date",placeholder:"选择结束日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(T,{label:"描述",prop:"description"},{default:d(()=>[t(I,{modelValue:V.value.description,"onUpdate:modelValue":a[3]||(a[3]=e=>V.value.description=e),type:"textarea",placeholder:"请输入计划描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-e930b7ab"]]);export{b as default};
