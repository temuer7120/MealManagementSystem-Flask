import{d as e,o as l,c as a,k as t,l as r,r as o,E as d,n as u,h as s,b as c,a as n,q as p,A as i,B as m,_}from"./index-D9a12nsq.js";import{a as v}from"./index-B1ATcuf8.js";const h={class:"health-container"},f={class:"card-header"},y={class:"dialog-footer"},b=_(e({__name:"Health",setup(e){const _=o([]),b=o(!1),g=o(null),V=o(!1),w=o({record_type:"",record_date:"",title:"",content:"",notes:""}),k=o({record_type:[{required:!0,message:"请选择记录类型",trigger:"change"}],record_date:[{required:!0,message:"请选择记录日期",trigger:"change"}],title:[{required:!0,message:"请输入记录标题",trigger:"blur"}],content:[{required:!0,message:"请输入详细内容",trigger:"blur"}]}),x=async()=>{try{const e=await v.get("/api/health_records");_.value=e.data}catch(e){d.error("获取健康记录失败")}},C=e=>{e?(V.value=!0,w.value={...e}):(V.value=!1,w.value={record_type:"",record_date:"",title:"",content:"",notes:""}),b.value=!0},U=async()=>{g.value&&await g.value.validate(async e=>{if(e)try{V.value?(await v.put(`/api/health_records/${w.value.id}`,w.value),d.success("记录更新成功")):(await v.post("/api/health_records",w.value),d.success("记录创建成功")),b.value=!1,x()}catch(l){d.error("操作失败")}})};return l(()=>{x()}),(e,l)=>{const o=u("el-icon"),q=u("el-button"),B=u("el-table-column"),j=u("el-table"),z=u("el-card"),I=u("el-option"),T=u("el-select"),$=u("el-form-item"),A=u("el-date-picker"),D=u("el-input"),E=u("el-form"),H=u("el-dialog");return s(),a("div",h,[t(z,{shadow:"hover"},{header:r(()=>[n("div",f,[l[8]||(l[8]=n("span",null,"健康记录",-1)),t(q,{type:"primary",onClick:C},{default:r(()=>[t(o,null,{default:r(()=>[t(p(i))]),_:1}),l[7]||(l[7]=c(" 新增健康记录 ",-1))]),_:1})])]),default:r(()=>[t(j,{data:_.value,style:{width:"100%"}},{default:r(()=>[t(B,{prop:"id",label:"记录ID",width:"80"}),t(B,{prop:"record_type",label:"记录类型"}),t(B,{prop:"record_date",label:"记录日期"}),t(B,{prop:"title",label:"标题"}),t(B,{prop:"summary",label:"摘要"}),t(B,{label:"操作",width:"150"},{default:r(e=>[t(q,{type:"primary",size:"small",onClick:l=>(e.row,void d.info("查看健康记录详情功能开发中"))},{default:r(()=>[...l[9]||(l[9]=[c(" 查看 ",-1)])]),_:1},8,["onClick"]),t(q,{type:"danger",size:"small",onClick:l=>{return a=e.row.id,void m.confirm("确定要删除该健康记录吗？","删除记录",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await v.delete(`/api/health_records/${a}`),d.success("记录删除成功"),x()}catch(e){d.error("删除失败")}});var a}},{default:r(()=>[...l[10]||(l[10]=[c(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(H,{modelValue:b.value,"onUpdate:modelValue":l[6]||(l[6]=e=>b.value=e),title:V.value?"编辑健康记录":"新增健康记录",width:"600px"},{footer:r(()=>[n("span",y,[t(q,{onClick:l[5]||(l[5]=e=>b.value=!1)},{default:r(()=>[...l[11]||(l[11]=[c("取消",-1)])]),_:1}),t(q,{type:"primary",onClick:U},{default:r(()=>[...l[12]||(l[12]=[c("确认",-1)])]),_:1})])]),default:r(()=>[t(E,{model:w.value,rules:k.value,ref_key:"formRef",ref:g},{default:r(()=>[t($,{label:"记录类型",prop:"record_type"},{default:r(()=>[t(T,{modelValue:w.value.record_type,"onUpdate:modelValue":l[0]||(l[0]=e=>w.value.record_type=e),placeholder:"选择记录类型"},{default:r(()=>[t(I,{label:"产后检查",value:"postpartum_check"}),t(I,{label:"新生儿检查",value:"newborn_check"}),t(I,{label:"体温记录",value:"temperature"}),t(I,{label:"血压记录",value:"blood_pressure"}),t(I,{label:"血糖记录",value:"blood_sugar"}),t(I,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),t($,{label:"记录日期",prop:"record_date"},{default:r(()=>[t(A,{modelValue:w.value.record_date,"onUpdate:modelValue":l[1]||(l[1]=e=>w.value.record_date=e),type:"date",placeholder:"选择记录日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t($,{label:"标题",prop:"title"},{default:r(()=>[t(D,{modelValue:w.value.title,"onUpdate:modelValue":l[2]||(l[2]=e=>w.value.title=e),placeholder:"请输入记录标题"},null,8,["modelValue"])]),_:1}),t($,{label:"详细内容",prop:"content"},{default:r(()=>[t(D,{modelValue:w.value.content,"onUpdate:modelValue":l[3]||(l[3]=e=>w.value.content=e),type:"textarea",rows:4,placeholder:"请输入详细内容"},null,8,["modelValue"])]),_:1}),t($,{label:"备注",prop:"notes"},{default:r(()=>[t(D,{modelValue:w.value.notes,"onUpdate:modelValue":l[4]||(l[4]=e=>w.value.notes=e),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-3dab1809"]]);export{b as default};
